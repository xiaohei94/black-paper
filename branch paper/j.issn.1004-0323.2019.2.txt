第

３４

卷

２０１９

第

２
月

年

４

期

遥

感

技

术

与

应

用

REMOTESENSING TECHNOLOGY AND APPLICATION

Vol．

３４
Apr．

No．
２

２０１９

引 用 格 式:

LuoYubo,Huang Hongyu,TangLiyu,

etal

structioninaForestbasedonTLS[J]．RemoteSensingTechnologyandApplication,２０１９,３４(２):２４３Ｇ２５２．[
遥 感 技 术 与 应 用
黄洪宇

胸径自动提取与 三 维 重 建

唐丽玉

等

基于地面激光雷达点云数据的森林树高
．

、

,

[J]．

,

,２０１９,

．Tree HeightandDiameterExtraction with３D ReconＧ
,

骆钰波

３４(２):２４３Ｇ２５２．]
doi:１０．１１８７３/j．issn．１００４Ｇ０３２３．２０１９．２．０２４３

基于地面激光雷达点云数据的森林树高、
胸径自动提取与三维重建

骆钰波,黄洪宇,唐丽玉,陈崇成,张

浩

(福州大学空间数据挖掘与信息共享教育部重点实验室,

地理空间信息技术国家地方联合工程研究中心,福建 福州

)

　３５０１０８

摘要:针对亚热带环境条件下森林树高、胸径自动化提取精度较低、单木形态模拟较为困难的问题,

提出基于地面激光雷达点云数据提取森林树高、胸径及重建 森 林 场 景 三 维 模 型 的 方 法.首 先 采 用

变尺度地面点识别法获取地面点并构建

.然后根据树木主 干 点 云 主 方 向 相 似 度 及 轴 向 分 布

密度分割主干与其他植物器官点云.接着以主干点云为基础,采 用 迭 代 最 小 二 乘 拟 合 圆 柱 的 方 法

DEM

自动提取树木位置、胸径;构建点云的八叉树结构,利用体素的空间邻接性实现点云分割,自动提取

树高.最后,结合单株植物建模技术,以树根节点为纽带构建样地尺度上的森林场景三维模型.实
;树 高 估 测 R２ 为
验结果显示,胸 径 估 测R２ 为
;所重建的森林场景三维模型可表达森林样地的真
,平均相对误差为

,平 均 相 对 误 差 为

,
RMSE

０．６６cm

２．０９％

为

为

０．９９６
,
RMSE

２．１６％

０．９２m

０．９７２
实形态.

关

键

词:地面激光雷达;树高;胸径;点云分割;三维重建

中图分类号

:TN９５８．５８;TP３９１．９;S７５７

文献标志码

文章编号

:A

:１００４Ｇ０３２３(２０１９)０２Ｇ０２４３Ｇ１０

引

言

１

植被 的 数 据

目 前 有 较 多 的 相 关 算 法

.Douillard
等 [３]在点云分割的方法总结中列举了三大主要地面

,

胸径

树 高 是 反 映 森 林 植 被 生 长 状 况 的 基 本 测

点识别模型

基于栅格地图的地面分割

基于面拟合

:

、

树因子

是决定森林空间结构的重要组成部分

是估

的地面分割 [４]以及基于地形网格的地面分割 [５]

、

,

算其他诸如树木材积

地上生物量

基地面积等森林

对重叠冠层进行

单木点云分割是研究难点

、

、

,

测度的基础 [１]

利用三维激光雷达技术高精度位置

采用空间体素 化 来 优 化 点 云 数 据 的 分 割 [６]

研 究 对

.

针

常

,

,

与 精 准 林 业 结 合

应 用

象基本为稀疏林分

人 工 种 植 区 等 简 单 生 长 关 系 的

TLS

、

.

表达

高密度目标 表 征 能 力

、

,
于森林参数的定量测量与反演

成功的先例 [２]

.

其中地面激光扫描

技术具有穿透性

,
已 经 有 了

在近

,

１０a

(TerrestrialLaＧ
能够探测林下
,

serScanning,TLS)
空间结构及地形

,

参数和数字地面模型

.

从

TLS

其 点 云 数 据 可 用 于 提 取 森 林 结 构

别不同目标 已 经 成 为 点 云 分 割 的 常 用 方 法

点云中 获 取 地 面 点 的 主 要 思 路 是 过 滤

等 [９]在多尺度下通 过 分 析 几 何 特 征 变 化 趋 势 来

Xia

树群

很难解决天然森林环境下

单木点云分割

树木主干 点 云 识 别 是 森 林 结 构 参 数 提

.
通过分析 点 云 空 间 分 布 的 几 何 特 征 来 识

TLS

,
的问题 [６,７]

取的基础

,

等 [８]根 据 点 云 法 方 向 分 布 判 断 主 干

在 此 基 础 上

.Liang
,

,

收稿日期

基金项目

作者简介

通讯作者

修订日期

:２０１８Ｇ０９Ｇ１５;
国家自然科学基金项目
:

骆钰波

黄洪宇

:

:

男
(１９９４－),
男
(１９７１－),

,

:２０１９Ｇ０２Ｇ２１

福建省科技引导性项目

(４１４７１３３４),

浙江绍兴人

,
福建莆田人

硕士研究生

,
助理研究员

(２０１６Y００５８).
主要从事地学可视化与虚拟地理环境研究

,
主要从事激光雷达和影像三维数据获取和分析研究

,

,

.EＧmail:hb１０６０８８６５２７＠１６３．com.

.EＧmail:hhy１＠fzu．edu．cn.














４４２

遥

感

技

术

与

应

用

识别不同目标

由于植被物体

如主干

枝干

木模型已经取得了一些成果

第

３４

卷

其中较难建模的是枝

.

木

叶子等

形态不 规 则 且 多 变 又 交 错 分 布

.

(

、

、

)

点云中识别不同目标仍具有很大的挑战性

草

灌

、

、
从 植 被

,

.

从树木

点云中提取 胸 径 可 以 达 到 较 高 精

度

主要方 法 有 二 维 曲 线 拟 合

如 圆 拟 合 [１０]

椭 圆

端以及细 叶

王 向 玉 等 [１８]提 出 基 于 点 云 密 度 进 行

树叶重 建

.
.Livny
然后 在 库 中 搜 索 枝 叶 模 板

等 [１９]以

Lobe
生 成
,
唐丽玉等 [２０]集 成 树 木 枝 叶 自 动 分 割 等 多 种 算

内 的 三 维 结

Lobe

,

的 形 式 表 示 枝 端

TLS

,
拟 合 [１１]

测 [１１,１３]

、

、Ransac

自 由 曲 线 拟 合 [１２]

提高了树木三维自动重建 的 精 度

黄 洪 宇 等 [２１]

圆 检 测 及 圆 柱 拟 合 [１４]等

将 点 云

概述了从树木激光点云数据中构建树木三维模型的

(

),Hough

、
变 换 圆 检

.

构

法

.

,

水平层根据轴 向 投 影 至 平 面 进 行 二 维 曲 线 拟 合 是

原理和方法

提取胸 径 的 方 法 之 一 [１０]

该 方 法 存 在 两 个 问 题

.
一是采用所有 点 云 参 与 运 算 的 曲 线 拟 合 方 法 并 不

,

目前关于地面激光雷达点云数据的研究对象大

多植被稀疏

林分结构简单

地形平坦

本文以福建

、

.

、

适合数据中存在噪声的情况

二是水 平 层 轴 向 与 半

省福州市亚热带山 区 森 林 为 研 究 样 地

着 重 针 对 噪

径没 有 一 起 计 算 带 来 的 精 度 损 失

采 用 二 维

点

低矮冠层点云

.

、

变换

最 小 中 值 法 等 鲁 棒 检 测 方 法

树木分层等情况

树 木 分 叉 及 树 木 之 间 交 错 生 长

、
开展森林树高与胸径的自动提取

,

但容易出现非树 干 点 云 误 检 为

并在此基础上重建样地尺度的森林场景三维模型

Hough
可避免噪声的影响

、Ransac、

,

、

,

.

;

.

.

,

研究区概况及数据获取

２

研究区位于福建省福州市晋安区国家森林公园

(１１９°１８′E、２６°０９′N),
北的一处山坡

主要树种为木荷

１

.
贝壳杉

数据采集

如 图

所 示

采 集 样 地 为 朝

,

、

.

形状时

提 取 精 度 较 差

等 [１５Ｇ１６]采 用 迭 代 圆

时间为夏天枝叶茂盛时期

样地长和宽均为

拟合提取胸径 大 小

可 滤 除 基 于 距 离 分 布 的 噪 声

但是很难滤除紧贴着树干表面的噪 声

这 些 噪 声 来

,

郁闭度约为

树木

株

,

２７

源于点云配准误差

树干出现分叉或 者 树 干 表 面 过

样地树木参数的具体情况如表

.
地 面 平 均 坡 度 为

１０ m,
样 地 共 有

９７％,
树木之间平均 水 平 距 离 为

２３°.

研 究

所示

１

１．６ m.
.

树干的情况

采用圆柱拟合代替圆可 解 决 三 维 降 到

二维计算造成的精度损失问题

但是 同 样 会 受 到 噪

;

基于以上分析

需对单一的 拟 合 方 法 进 行

刘鲁霞等 [１３]通 过 内 圆 检 测 提 高

变换识别树干点云的准确性

Hough
但是在 树 干 呈 不 规 则

声影响

.
加工处理

.

,

,

,

.Cabo

,

、

.Liang

,

,

,

.

于 粗 糙 等 情 况

等 [１４]采 用 圆 柱 拟 合 提 取 胸

径

根据

,
情况时

估计减小噪声 的 影 响

在 树 木 出 现 分 叉

M
通过设定拟合初值来控制拟 合 过 程 以 保 证

,

来自于主干的点可以得到更大的权值

基于

点云的树高测定方法提取精度较低

TLS

误差可达几米且往往被低估

单木树高难以准确计

算的主要 原 因 是 树 冠 相 连 或 被 其 他 树 木 的 树 冠 遮

,

.

.

.

挡

因此

容易准确 获 取 相 对 稀 疏 样 地 内 单 木 树 高

点 云 数 据 采 集 设 备 为

地 面 激 光

,

,

单木树高定义为单木中心一定影响范围内最高点与

扫描方案采用基于人工标靶拼接的多站扫

RieglVZＧ４００

最低点的高度差

根 据 该 定 义

.

是确定点与单木的归属关系

首 先 最 关 键 的 问 题

,
通过判定点云量或体

设站位置如图

黄色三角所示

分别以竖直

１

,

模式和水平模式 进 行 扫 描

扫 描 角 分 辨 率 为

扫描仪

描模式

.

,

元量在垂直方向上的连续性以确定树顶点的方法只

多站拼接精度控制在

,

０．０８°.
点 云 平 均 间 距 约 为

０．００５ m.

能反映点云数量的 变 化

不 能 准 确 地 对 不 同 层 次 的

树木进 行 分 类

因 此 该 方 法 对 树 高 的 提 取 精 度 不

,

取值为样地点云间距的中位数

使用卷尺

０．０２ m(
实地测量样地内每 棵 树 胸 径

).
使 用 标 准 伸 缩 测 高 杆

高 [１１,１３,１５Ｇ１６]

.
提取产生影响

,

.

,

其次单木影响范 围 的 大 小 也 会 对 树 高

很多研究根据胸径大小确定影响半

测量每棵树的树高与枝下高

.
测量数据在同一时间段内完成

点云数据采集与实地

径 [１１,１３,１７]

该方法没 有 考 虑 较 近 树 木 可 能 存 在 的 茂

密冠层对于 单 木 的 遮 挡

与 之 相 反

;
影响区域定义为根 据 树 木 中 心 生 成 的 泰 森 多 边 形

,Cabo

等 [１５Ｇ１６]将

却忽略了单木差异性所带来的影响

采用 变 尺 度 方 法 [２２]分 割 样 地 点 云

从大 量 离 散 三 维 点 云 中 模 拟 树 木 形 态

面点和植被点

利用反距离加权对地 面 点 内 插 生 成

２
获 得 地

,

样地树高

胸径提 取 和 三 维 重 建 的 流 程 如 图

研究方法

,

３

所示

.

、

,

.

重 建 单

,

,

.

表１

样地树木情况调查表

Table１

Themeasuredfielddataattheplot

平均值

标准差

极差

胸径

/cm

树高

/m

枝下高

/m

１０．９

９．４１

３．４７

７．３

５．５１

２．１９

２８．４

１９．７４

７．４９













第

期

２

骆钰波等

基于地面激光雷达点云数据的森林树高

:

胸径自动提取与三维重建

、

５４２

并采 用 高 斯 滤 波 法 进 行 优 化

计 算 植 被 点

点集构造八叉树

根据体素的空间邻 接 性 对 点 集 进

根据主干点云主方向相似度 及 轴 向 分 布 密

行分割

求解与单木主干包围盒的最 大 交 集 确 定 树

DEM,
主方向

,

度区分主干与其他植物器官

以主 干 点 云 为 基 础

.

,

最后

利用基于点 云 的 单 株 植 物

,

采用迭代最小 二 乘 法 对 单 木 主 干 点 云 水 平 层 进 行

建立单树三维模型

根据单 木 位 置

将 三

圆柱拟合

求得 胸 径 及 单 木 位 置

根 据 多 层 圆 柱 平

种植

在地形模型上

重建 逼 真 的 森 林

,

,

,

,

均轴向构造单木圆柱型影响区域

对 影 响 区 域 内 的

,

.

,
顶点并提取树高

建模方法

,
维树木模型

“
场景三维模型

”

.

.

;

,

图１

研究区域及扫描站点位置示意图

Fig．１

Mapofresearchareaandscannerlocation

图２

基于 TLS点云的森林结构参数提取(树高与胸径)及三维重建方法流程图
Flowchartofstructureparametersextraction(TH,DBH)and３DreconstructionatplotbasedonTLS

Fig．２

３．１

数字高程模型构建

步骤

为增加算法效率

对原有变尺度方法进行改进

,

,

只在最后一次迭代 中 绘 制 地 形 三 角 网

并 将 移 动 最

小二乘拟合二次曲面过滤非地面点方法 [５]加入到算

,

根 据 点 集S

以 格 网 大 小 Ω

Ω

２)、

(３):
Φ
２)
２(
最后一次迭代中

重复步骤

１,

Φ

阈值Φ
步骤

１＞

１~２
根据网格最低点P
,
,
以 相 应 的 阈 值Φ
利用移动 最 小 二 乘 拟 合 二 次 曲 面
,
得到初始地面点

截取离二次曲面距离小于Φ 的点

(４):

进行运算

１ ＞

.

Ω
２ (

.
,
以最后一次迭代所获取网格内最低点

步骤

法中

.
具体计算过程如下

(１):

大小Ω

剖分点云数据

１
步骤

(２):
１,

差阈值Φ
其余点则摒弃

:

.

步骤

将原始 点 云 投 影 到 XY 平 面

以 格 网

,

作为地形点

插值构建

并 通 过 高 斯 滤

波进行优化

通 过

绘 制 地 形 三 角 网 过 滤 非 地

IDW

DEM

提取每个网格内的最低点P

设定高

面点获得最终地面点

截取网格内各点与P

０,
高差小于Φ

０

的点

１

本研 究 样 地 通 过

个 站 点 的 扫 描

数 据 比 较 完

所有网格内保留的点构成点集S
,

１.

可设Ω
,

１＝２m;

其地形呈梯田状

,
设Φ
,

以
１＝２m,

,

整

DEM
.

５

(５):
以
,

,









６４２

遥

感

技

术

与

应

用

第

３４

卷

防止地面点被剔 除

整 个 过 程 迭 代 执 行

无章

因此依据主干轴向分布密度及轴向相似度进

次

每 次

,

.

.

循环Ω 和Φ 值各减小一半
主干点云分割
３．２

如图

,

３

所示

３
.

原始 点 云 经 过 地 面 点 滤 波 之 后

包 含 主 干 点 云

为点云主方向

等其他目标点云

主方向趋于一致

.

;

主 干 点 云 分 布 呈 圆 柱 状

其 点 的

,

,

叶 子 点 云

小 叶 植 物

(

)

主 方 向 杂 乱

点主方向为轴向构建一定高度的圆柱体

行树木主 干 的 分 割 [２３]

根 据 主 成 分 分 析 法 搜 索 点

云的近邻点邻域

以 最 大 特 征 值 对 应 的 特 征 向 量 作

.

,
具体计算过程如下

.
选取 植 被 点 云 中 一 点 为 中 心 点

:

步骤

(１):

以 该

,

.

图３

三次迭代获取地面点结果

Fig．３

Extractedgroundpointinthreeiterations

(２):

间的夹角

分布均匀

,

,

步骤

(３):
(２)~(３),
步骤
(４):

骤

度

步骤

将圆 柱 内 点 集 投 影 至 轴 线

计 算 点 集

成的精度损失

采用 迭 代 加 权 最 小 二 乘 减 小 噪 声 影

,

;

的轴向分布密度及点集内主方向与中心点主方向之

响

设计一种从下而上依次拟合水平层圆柱的方式

判定 该 点 是 否 属 于 主 干 点

若 点 集 轴 向

找出拟合错误的圆 柱 并 删 除

利 用 多 层 圆 柱 拟 合 平

则该圆柱 体 内 点 云 主 方 向 与 中 心 点 主 方

均轴向得到树木生长方向以提取单木树高

,

.

向夹角小于一定阈值的点即为主干点

;

圆柱拟合

３．３．１

以新 加 入 的 主 干 点 为 中 心 点

重 复 步

,

至遍历完所有的植被点云

三维仿射空间R３中的正圆柱体
如公式

定直线固定距离处点的集合

,

定义为位于给

.

.

.

;

,

使用聚类方法对候选主干点进行分组

本文 单 位 圆 柱 体 高 度 选 取

１０
倍 的 点 云 平 均 密 度

样地主干点云分割结果如图

半径选取

２

,
度

２０

.

.
倍 的 点 云 平 均 密

角 度 阈 值 选 取

,

４

所示

.

所示

(１)
:
)×a － １

d

s
(

,p)＝ (p－ (ρ＋ １

n
k)

k (１)
d 代 表 点p 至
T 为 空 间 中 一 点
)
,
轴 向a 和 法 向n 以 球 面 坐 标 表

其中

:p

x
＝(

z
,y,
圆柱 表 面 的 距 离
.

示

如图

所示

,

５

.

图４

树木主干分割示意图

Fig．４

Schematicoftrunksegmentation

３．３

森林结构参数提取

径倒数

以确定圆柱的大小

基于主干点云数据

采用圆柱拟合提取胸径

以

,

,

避免主干点云水平层轴向与半径没有一起计算而造

图５

正圆柱体参数化

Fig．５

Parameterizationofrightcircularcylinder

给出圆柱在 球 坐 标 系 下 的 轴 向

,ψ)

θ
((
向n 一同给 出 圆 柱 的 方 位

nθ
,

nφ)
,

n
;(
;ρ为 圆 柱 距 原 点 的 最 近 距 离
)

构 成 正 交 基 与 法

k 为 圆 柱 半
;

,



















第

期

２

采用

骆钰波等

基于地面激光雷达点云数据的森林树高

:

胸径自动提取与三维重建

、

７４２

非线性 最 小 二 乘 法

即可解决三维空间中

求解如公式

LevenbergＧMarquardt
所示目标函数
,

(２)

向的具体参数化方法

.Luk􀅡cs
.

圆柱 拟 合 问 题

等 [２４]给 出 了 圆 柱 轴 向 及 法

d２

s
(

,pi)

min∑i

现实激光雷达 数 据 的 采 集 往 往 伴 随 着 噪 声

k

(１/

),

以 二 维 圆 圆 心 至 原 点 的

确定初始 圆 柱 半 径
距离为初始ρ值
胸径提取

.

３．３．２

本文以固 定 厚 度

将 单 木 主 干 点 云 切 割 成 一

(２)
这

,

系列垂直分布的水 平 层

从 下 往 上 以 上 述 拟 合 圆 柱

的方法依次计算每一水平层圆柱参数

删除因树木

分叉

低矮冠层 点 云 造 成 的 错 误 圆 柱 拟 合 层

同 时

t,
,

.

.

.
具体算法过

些噪声依附在树干 表 面 难 以 剔 除

近 邻 的 细 小 枝 叶

、

;

通过多层圆柱拟合得到树木生长方向

点也会对圆柱拟合产生影响

本文采用迭代加权最

.
通过给予观 测 值 不 同 权 重 以 减 小 粗 差 值 对

小二乘

,
圆柱 拟 合 的 影 响

.
计算观测值权重 [２５]

由

Tukey’sBiweight

如公式

所示

目 标 函 数

w

x
(

式

(３)

,
x
－ (

(３)
２
,
]

.
if|x|

≤

c

２
)

０,

c
/

{
)＝ [１
if|x|
中c是 一 个 调 整 因 子 并 且 设 为

＞
４．６８５１,
V
s
,
/
s 是 对 残 差V 未 知 标 准 偏 差σ
,
根 据 标 准 化 残 差 大 小 赋 予 相 对 应 观 测 值

的效 率

(３)

９５％

c

V

x

＝

.

对应于标准正态分布大约

代表观测值 的 残 差

下次 迭 代 的 权 重

)

迭 代 最 小 二 乘 如 公

,

的估计

.

点三维坐标

(
式

所示

(４)

.

k－

w

r(
(

１)i )

ri ２

s
(

,pi)

应 在 每 次 迭 代 后 重 新 计 算

min∑i

其中

k
r(
－１)
i )
(
下一次 迭 代 中 使 用

w
:

(４)
以 便 在

非 线 性

,

最小二乘法稳健性 依 赖 于 初 值 的 选 取

本 文 圆 柱 参

.LevenbergＧMarquardt

数初值通过高斯映 射 法 获 取

采 用 二 次 曲 面 拟 合 实

,

:

,

,

现单位法向量的计 算

根 据 理 想 圆 柱 侧 面 点 的 法 向

与圆柱轴向垂直这 一 原 理

运 用 线 性 最 小 二 乘 拟 合

法向得到圆柱初始 轴 向

根 据 轴 向 将 点 云 投 影 至 过

原点平 面

通 过

,

Ransac

,
检 测 二 维 圆

以 二 维 圆 半 径

,

程如下

:
步骤

合骨架点

从最 低 水 平 层 开 始 计 算 圆 柱 参 数

拟

(１):
骨架点方向为该拟合圆柱轴向
,

,

,

骨架点半

径为该圆柱半径

.

(２):

步骤

计算 上 层 圆 柱 参 数 并 拟 合 骨 架 点

连

;

接上层骨架点与下 层 骨 架 点 成 骨 架 线

骨 架 线 的 方

向为从下层骨架点指向上层骨架点

,

.

步骤

计 算 上 层 骨 架 点 方 向 与 骨 架 线 夹 角

计 算 下 层 骨 架 点 方 向 与 骨 架 线 夹 角k

是否都 小 于 给 定 角 度 阈 值

若 是

判 定k
１
则 上 层 骨 架

２;

(３):

k
１;
与k
点加入树木主干骨架点

２

若不是

,

,
跳过该层

.

,

.

步骤

重复步骤

至 遍 历 完 所 有 的

(４):
单木点云水平层

.

(２)~ (３),

由于树木主干存在弯曲生长

主 干 曲 线 变 化 快

的情况

因此 点 云 切 片 厚 度

的 取 值 不 宜 过 大

时单一水平层拟合圆柱需要足够多 的 点 云 量

,

、

t

经 实 验 分 析

厚度t的取值又不宜过 小
片厚度t取 值 为
与k
设为
性及无偏性

２

.
同 时 将 轴 向 角 度 阈 值k
０．２ m.
１
上 述 算 法 保 证 了 圆 柱 轴 向 的 连 续

,

１５°.
.
红 色 物 体 即 为 随 着 主 干 垂 直 分 布 的 拟

图

６(c)

同

;
因 此

,
将 点 云 切

图６

多层圆柱拟合示意图

Fig．６

MultiＧlayercylinderfit

合圆柱

由于树木分叉等导致拟合错误的情况

处的拟合圆柱

其直径作为该树木胸 径

若 位

,

被自动删除

如 图

,

的 蓝 色 点 云

６(c)

距 地 表

.

圆柱

,

１．２~

１．４ m
于该水平层的拟合 圆 柱 被 删 除

,

;

则 通 过 上 下 两 层 圆

,










８４２

遥

感

技

术

与

应

用

第

卷

３４

柱的直径平均值 加 以 代 替

位 于 最 低 点 的 圆 柱

其

方框即为根据包围盒最大交集求解得到属于该单木

中心作为初始单木 位 置

并 将 初 始 位 置 垂 直 下 移 至

的点云

地表表面作为最终单木位置

样地内单木位置和胸

３．４

场景三维重建

,

.

.

,

.

径示意图

如 图

所 示

空 心 圆 半 径 表 示 胸 径 大

结合上述分割出的点云

采用

基 于 点

,

６(f)

,

小

实心圆表示地面激光雷达测站位置

云的参数 化 单 树 建 模 工 具 建 立 单 株 树 木 的 三 维 模

,

PC２TreeＧ

,

３．３．３

树高提取

森林 中 单 木 之 间 生 长 结 构 复 杂

存 在 上 层 木 及

下层木

不同层次树木影响区域也不同

将影响区

集成于

型 [２０,２６]

根据树木分布 位 置

,“
重建逼真的森林场景三维模型

,

种 植

在 地 形 模 型 上

,

场景三维建模方法

”

.

PC２Tree

系统中

.

.

,

.

、

.

.

,

域定义为以树木生 长 方 向 为 轴 向

一 定 半 径 大 小 的

圆柱体

以上述多层圆柱轴向平均值作为树木生长

方向

半径根据单木 主 干 的 胸 径 大 小 及 与 邻 近 主 干

的高度差确定

如公式

－h

－h

１

ì
h
ïï
í
h
１
ïï
î
else

２＞２
－

２＜

所示

(５)
上层木

.

.
u t
１
u t
１
２
t
t
１、
２

下层木

等高

２

＝d＋

×r

R

R

R

２
×r

１
×d

＝

４

＝

．
５

０

其中

的水平距离

d 为两相邻单木t
:

干点云高分别为h
本文中u设为
因子
,
如何确定点与单木的归属关系是提取树高的关

t
１、
２
胸径分别为r
R 为确定的圆柱体半径

,
r
１、

u为尺度

h
１、

１.

２.

２,

.

(５)
分割出的主

.

键问题

上层木与下层木之间一般情况下会有大于

平均点云密度的 空 隙

对 点 集 构 建 八 叉 树

利 用 体

.

,

素的空间邻接性实 现 点 云 分 割

通 过 求 解 分 割 后 点

云包围盒与主干点云包围盒最大交集判定区域内属

于单木的真实点云

从而提取树高

,

.

实际情况中仍然存在细碎点云分布在上层木一

,

图７

基于八叉树的点云分割

Fig．７

Pointcloudsegmentationbasedonoctree

单木及地形三维重建

３．４．１

研究样地位于亚热带山区

生长结构较为复杂

,

,

利用现有方法无法全自动从森林点云中分割出单木

侧与下层木顶端之 间

通 过 基 于 密 度 分 布 检 测 的 滤

,
波器剔除上层木与 下 层 木 之 间 的 稀 疏 点 云

,
层木与下层木之间的空隙以便进行点云分割

制 造 上

具体

.

的树高提取方法如下

:

步骤

(１):

木圆柱型影响区域

以生长 方 向 为 轴 向

R 为 半 径 构 造 单
,
R 由 近 邻 单 木 之 间 的 距 离 以 及
,

单木胸径确定

步骤

(２):

.
单木主干点云以及被包含在影响范围

３．４．２

内的非主干点云作为估算树高的点集

.

步骤

针对该点集

若单木为下层木

,

行滤波处理

对滤 波 后 的 点 集 构 造 八 叉 树

(３):
.

首先进

,
通 过 体

,

素的空间邻接性实 现 点 云 分 割

与 主 干 包 围 盒 具 有

最大交集的认为是 属 于 单 木 的 点 云

确 定 该 类 最 高

,

;

最高点与根节点在Z 方向上的差值即为树高
,
本实 验 中 体 素 大 小 选 取

.
倍 的 点 云 平 均 间 距

为单木圆柱型影响区域内基于八叉树结构的点

５

.

点

图

７

云分割示意图

不同颜色的点云和体素代表分割结

.

点云

现阶段通过上述单木影响区域内基于八叉树

点云分割结果

结合手动裁剪

提取出完整的单木点

,

,

云

将每一单木点云输入

,

并保存为

PC２Tree
如 图
,
字高程模型生成地 面 三 角 网

格 式 文 件

．pctm

软 件 中 进 行 建 模

所 示

通 过 数

８(a)

.

采 集 地 形 纹 理 并 映 射

至三角面片构建地形景观

森林场景三维重建

,
如图

,

所示

８(b)

.

利用 单 株 树 木 位 置 这 一 纽 带

将 单 株 树 木 模 型

,

.

依次加载至地形模型表面上

重建基于样地尺度的

森林场景三维模型

如图

所 示

本 文 算 法 下 单

,

８(c)

.

木位置精度为

满足场景重建要求

单木位置

４cm,

.

的精度分析采用以下方式

手动裁剪单木根部点云并

剔除噪点

:
利用圆柱拟合提取正确根节点

上述算法所提取根节点的水平偏差

丛的影响

不利于近地表面主干薄层的提取

,
由于杂草

并计算与

灌木

、
而在本

,

.

,

,

文样地坡度较大情况之下

,
生长状况与倾斜山坡相结合

近地表面主干的快速垂直

造成提取的主干位置与

.

果

图

.

７(d)

蓝色透明方框为主干点云包 围 盒

红 色

,

真实树木根节点有所偏差

,

所示

１０(a)

.

,
如图













第

期

２

骆钰波等

基于地面激光雷达点云数据的森林树高

:

胸径自动提取与三维重建

、

９４２

图８

森林场景三维建模示意图

Fig．８

Schematicdiagram３D modelingofforestscenes

图９

单木树高、胸径提取精度分析图

Fig．９

Accuracyanalysisdiagramoftreestructureparameterserror

结果与分析

４

样地 的 真 实 树 高 采 用 标 准 伸 缩 杆 测 量

.

点云数据查看

最 大 值 可 达

,

２２ m;

存 在 一

,

但是经过

２０ m,
同 时 从 下 往 上 查

看树顶点存在人为误差

因此本研究在单木点云自

动分割后

结合手动精细分割

将真实树高值定义为

单木点云 最 高 点 与 最 低 点 在

方 向 的 差 值

本 文

,

.

,

Z

,

相对误差为

绝对误差绝对值最小为

２．０９％;

.

平 均

最 大

０．９９６,
０,

定误差

标准伸缩杆可测最大值为

胸径提取值与实测值 相 比

决 定 系 数 为








０５２

遥

感

技

术

与

应

用

第

卷

３４

为

１．７１cm,RMSE
径绝对误差控制在

为

０．６６cm;９０％

以上的树木

其胸

,

以内

树高提取值

０．７~－１．１cm

;

与实测值 相 比

决 定 系 数 为

平 均 相 对 误 差 为

２．１６％;
为

RMSE
差控制在

,

绝对 误 差 绝 对 值 最 小 为

最 大 为

０．９７２,
０,
以 上 的 树 木

０．９２ m;９０％

３．０６ m,
其 树 高 绝 对 误

,

１．２６~－１．５１ m

.

树高提取精度较高

具体精度分析如图

所示

、

以内

本文 算 法 对 胸 径

样地共有树木

棵

自 动 检 测 到

棵

棵

不存在过检 情 况

,

２
漏 检 原 因 是 被 漏 检 的 单 木 主

２５

,

９

.
漏 检

,

２７

.

且 周 围 长 有 杂 草

胸径小于

１０cm

扫 描 数 据 不 规 则

,
的胸径反演精度相对较

,

如

经分析得出

较细的枝干点云分布相对不规则

,
干较 细

,

图

低

１０(b).
.

,

根据以上结果与分析得出以下总结

:

,

胸径和树高的精度受测量手段的影响

实测

枝干周长误差一般在

用标准伸缩杆实测

±０．００５ m,

.

树高误差有时高达数米

本文通过量取单木点云包

围盒的方式定义实测树高值

.
胸径误差主 要 来 源 于 拟 合 圆 柱 时 的 点 云 分

布状况

较细的枝干点云分布相对不规则

径较大时单木胸径提取精度较高

.

树高误差主要来源于树木冠层之间的交错

(１)

(２)
,

(３)

样地单木的平均轴向与Z 正轴夹角达到

因此

胸

,

.

;

在树高

５°,
的 水 平 距

１０ m
离
;

,

的 情 况 下

的 夹 角 可 以 达 到

,５°
样地内单木平均水平距离为

１ m

１．６ m
不仅影响算法有效性

,

左右

容易导

,

还影响实测

,

用于圆柱拟合的点云数较少

易受噪声影响

但水平

致树木冠层重叠

层在合理的轴向范围内

没被算法剔除

因此相对误

值的量取

,

,

,

,

树 高 误 差 来 源 为 单 木 与 邻 近

在单株点云 出 现 断 层 或 者 是 由 于 森 林 顶 部

导致滤波器无法滤出足够的空隙

结构遮挡与测距能力限制从而造成冠层点云极为稀

木荷 的 树 高 提 取 精 度 略 低 于 贝 壳 杉

疏的情况

不利 于 本 文 算 法 树 高 的 提 取

因 此 实 验

(４)

.

,

,

,

差较大

如 图

,
上层木非常靠近

１０(c).
,

如图

１０(d).

决定系数为

如 图

所 示

其 原 因 为 木 荷 平

均高度较高

０．９２８,
受视角 限 制 及 上 层 结 构 遮 挡 导 致 冠 层
,
点云相对稀疏

基 于 八 叉 树 剖 分 的 树 高 提 取

因 此

１１

.

.

,

方法无法连接顶层体素部分

而增大体素分辨率则

会导致上层木与下层木无法区分

.

.

在多站模式下结合 水 平 视 角 与 垂 直 视 角 进 行 扫 描

最大化程度地减少了稀疏冠层点云对于本文算法树

.

,

高提取的影响

.

结

语

５

主干分割

解决方案

、

.

,

提出了一套从地面点识别

数字高程模型构建

、
树高与胸 径 提 取 到 森 林 场 景 三 维 重 建 的

、

基 于 迭 代 最 小 二 乘 拟 合 圆 柱 法 提 取 胸

径

可以减小噪声的影响

设计自下而上依次拟合圆

柱的方式可以避免 树 木 分 叉

低 矮 冠 层 点 云 对 胸 径

提取的影响

通过体 素 的 空 间 邻 接 性 判 定 单 木 影 响

区域内点与树木的归属关系

从而确定树高

可以避

;

免上层木对树高提 取 的 影 响

将 单 木 模 型 根 据 其 空

间位置加载至地形 模 型 上

可 重 建 样 地 尺 度 内 基 于

;

、

,

;

,

地面激光雷达点云数据的森林三维场景

,

.

在多站模式下结合水平视角与垂直视角扫描进

行实验

弥补了视线遮挡带来的点云分布不规则

树

冠 层 点 云 较 为 稀 疏 的 缺 点

后 续 将

、

.

,

木细节不完整

、
研究单站模式下

地面点识别

数字高程模型构建以

,

、

及参数精 确 提 取 的 研 究

冠 层 结 构 对 于 激 光 的 遮

挡

使得

,

TLS

所获 得 的 树 木 顶 部 点 云 不 完 整

在 未

,

来将会结合机载激光雷达点云和摄影测量影像匹配

.

点云

融合

展开如何在高 郁 闭 度 森 林 下 实 现 数 据 的 自 动

,

.

参考文献(References):

[１]　Newnham GJ,ArmstonJD,CaldersK,

．TerrestrialLaＧ

etal

图１０

样地点云数据分析

Fig．１０

Pointcloudanalysisoftheplot

图１１

不同树种树高精度分析图

Fig．１１

Accuracyanalysisdiagramoftreeheight

aboutdifferenttreespecies
















第

期

２

骆钰波等

基于地面激光雷达点云数据的森林树高

:

胸径自动提取与三维重建

、

１５２

serScanningforPlotＧscaleForest Measurement[J]．Current
ForestryReports,２０１５,１(４):２３９Ｇ２５１．
[２]　LiWenjuan,ZhaoChuanyan,BieQiang,

．Retrievalofthe

etal

ForestStructuralParameters Using Airborne LiDAR Data
[J]．RemoteSensing Technologyand Application,２０１５,３０
基于机载激光雷 达 数
．

李文娟

赵传燕

别强

等

(５):９１７Ｇ９２４．[
,
据的森林结 构 参 数 反 演

,
,
遥 感 技 术 与 应 用

[J]．

,２０１５,３０(５):

９１７Ｇ９２４．]

[３]　DouillardB,UnderwoodJ,KuntzN,

．OntheSegmentaＧ

etal

tionof３DLiDARPointClouds[C]∥ProceedingsoftheIEEE

InternationalConferenceonRoboticsandAutomation,ShangＧ

hai,２０１１．

[４]　SongB,ZhengNS,Dong W L,

．ReconstructingDEM UＧ

etal

singTLSPointCloudDataandNURBSSurface[J]．TransacＧ

tionsof Nonferrous MetalsSocietyofChina,２０１５,２５(９):

３１６５Ｇ３１７２．

[５]　LiuC,LiJ,ZhangS,

．APointCloudsFilteringAlgorithm

etal

basedonGridPartitionand MovingLeastSquares[J]．ProceＧ

diaEngineering,２０１２,２８:４７６Ｇ４８２．

[６]　ZhongLS,ChengL,Xu H,

．SegmentationofIndividual

etal

Treesfrom TLSand MLSData[J]．IEEEJournalofSelected

Topicsin AppliedEarth Observationsand RemoteSensing,

２０１７,１０(２):７７４Ｇ７８７．

[７]　ParisC,KelbeD,AardtJV,

．A NovelAutomaticMethod

etal

fortheFusionofALSandTLSLiDAR DataforRobustAsＧ

sessmentofTreeCrownStructure[J]．IEEE Transactionson

Geoscience & RemoteSensing,２０１７,５５(７):３６７９Ｇ３６９３．
etal

[８]　XiaSB,WangC,PanFF,

．DetectingStemsinDenseand

HomogeneousForest Using SingleＧScan TLS[J]．Forest,

２０１５,６(１１):３９２３Ｇ３９４５．

[９]　XiaSB,WangC,PanFF,

．DetectingStemsinDenseand

etal

刘 鲁 霞

庞 勇

李 增 元

２６Ｇ３７．[
,
林单木胸径与树高提取

,

林业科学

基 于 地 基 激 光 雷 达 的 亚 热 带 森
．

[J]．

,２０１６,５２(２):２６Ｇ３７．]

[１４]　LiangX L,LitkeyP,HyyppaJ,

．AutomaticStem MapＧ

etal

ping UsingSingleＧScan TerrestrialLaserScanning[J]．IEEE

Transactions on Geoscience and Remote Sensing,２０１２,

５０(２):６６１Ｇ６７０．

[１５]　CaboC,OrdóñezC,LópezＧSánchezCA,

．AutomaticDenＧ

etal

drometry:TreeDetection,TreeHeightandDiameterEstimaＧ

tionusingTerrestrialLaserScanning[J]．InternationalJournal

ofAppliedEarth ObservationandGeoinformation,２０１８,６９:

１６４Ｇ１７４．

[１６]　CaboC,PozoSD,RodríguezＧGonzálvezP．ComparingTerresＧ

trialLaser Scanning(TLS)and Wearable Laser Scanning

(WLS)forIndividualTreeModelingatPlotLevel[J]．Remote

Sensing,２０１８,１０(４):１Ｇ１６．

[１７]　SrinivasanS,PopescuS,Eriksson M,

．TerrestrialLaser

etal

ScanningasanEffectiveTooltoRetrieveTreeLevelHeight,

Crown Width,andStem Diameter[J]．RemoteSensing,２０１５,

７(２):１８７７Ｇ１８９６．

[１８]　WangXiangyu,XieDonghui,WangYan,

．３D Reconstruction

etal

ofaSingleTreefrom TerrestrialLaserScannerData[J]．Remote
王向

SensingTechnologyandApplication,２０１５,３０(３):４５５Ｇ４６０．[
玉

基 于 地 面 激 光 雷 达 点 云 数 据 的 单 木 三 维
．

谢东辉

汪艳

等

,
重建

,

,
遥感技术与应用

[J]．

,２０１５,３０(３):４５５Ｇ４６０．]
etal

[１９]　LivnyY,PirkS,ChengZ,

．TextureＧlobesforTree ModＧ

eling[J]．Acm TransactionsonGraphics,２０１１,３０(４):１Ｇ１０．

[２０] TangLiyu,ZhangHao,HuangHongyu,

．ImprovedMethＧ

etal

odfor３DReconstructionofTreeModelbasedonPointCloud

Data[J]．TransactionsoftheChineseSocietyforAgricultural

Machinery,２０１７,４８(２):１８６Ｇ１９４．[
基于点云数据的树木 三 维 重 建 方 法 改 进

,

,

,
农 业 机 械 学 报

唐 丽 玉

张 浩

黄 洪 宇

等

．

,

[J]．

HomogeneousForest Using SingleＧScan TLS[J]．Forest,

２０１７,４８(２):１８６Ｇ１９４．]

２０１５,６(１１):３９２３Ｇ３９４５．

[１０]　NiWenjian,GuoZhifeng,SunGuoqing,

．ResearchonExＧ

etal

[２１]　 Huang Hongyu,Chen Chongchen,ZouJie,

．Tree GeoＧ

etal

metrical３D Modelingfrom TerrestrialLaserScannedPoint

tractionofTreeStructureParametersfrom TerrestrialLaser

Data[J]．ChineseHighTechnologyLetters,２０１０,２０(２):１９１Ｇ
基 于 地 基 激 光 雷 达 数 据 的
等
．

孙 国 清

过 志 峰

倪文俭

,

１９８．[
单木结构 参 数 提 取 研 究

,

,
高 技 术 通 讯

Clouds:A Review[J]．ScientiaSilvaeSinicae,２０１３,４９(４):
基于地面激光雷达点 云 数
,
．
林业科学

１２３Ｇ１３０．[
据的单木三维建模综述

陈崇成

黄洪宇

邹杰

,

,

等

[J]．

,２０１３,４９(４):１２３Ｇ１３０．]

[J]．

,２０１０,２０(２):１９１Ｇ

[２２]　 Huang Hongyu,Chen Chongchen,ZouJie,

．Tree GeoＧ

etal

１９８．]

metrical３D Modelingfrom TerrestrialLaserScannedPoint

[１１]　LiDan,PangYong,YueCairong,

．ExtractionofIndividuＧ

etal

alTreeDBHand HeightbasedonTerrestrialLaserScanner

Data[J]．JournalofBeijingForestry University,２０１２,３４(４):
数 据 的 单 木 胸 径 和

岳彩 荣

庞勇

李丹

等

７９Ｇ８６．[
,
树高提取研究

,
,
北京林业大学学报

基 于
．

TLS

Clouds:A Review[J]．ScientiaSilvaeSinicae,２０１３,４９(４):
基于地面激光雷达点 云 数
,
．
林业科学

１２３Ｇ１３０．[
据的单木三维建模综述

陈崇成

黄洪宇

邹杰

,

,

等

[J]．

,２０１３,４９(４):１２３Ｇ１３０．]

[２３]　DaiMingrui,ZhangXiaopeng,LiHongjun．TreeReconstrucＧ

[J]．

,２０１２,３４(４):７９Ｇ８６．]

tionbasedon RangeImage with Strong Noise[J]．Chinese

[１２]　Pfeifer N,WinterhalderD．ModellingofTreeCrossSection

from TerrestrialLaserScanningDatawithFreeＧform Curves

[J]．ProceedingsofISPRS WorkshopLaserＧScannersforForＧ

JournalofStereology & Image Analysis,２０１０,１５(２):１０９Ｇ
基 于 高 噪 声 深 度 图 像 的 树 木 模
．

代明睿

张晓鹏

李红军

１１４．[
型重建

,

,
中国体视学与图像分析

[J]．

,２０１０,１５(２):１０９Ｇ１１４．]

estandLandscapeAssessment,２００４:７６Ｇ８１．

[２４]　LukácsG,MartinR,MarshallD．FaithfulLeastＧSquaresFitＧ

[１３]　LiuLuxia,PangYong,LiZengyuan．IndividualTreeDBHand

tingofSpheres,Cylinders,Conesand ToriforReliableSegＧ

HeightEstimationUsingTerrestrialLaserScanning(TLS)in

mentation[C]∥ProceedingsofTheEuropeanConferenceon

aSubtropicalForest[J]．ScientiaSilvaeSinicae,２０１６,５２(２):

ComputerVision,Berlin,１９９８．




２５２

遥

感

技

术

与

应

用

第

卷

３４

[２５]　ZhangZ．ParameterEstimation Techniques:A Tutorialwith

Application to Conic Fitting [J]．Water Research,１９９７,

３９(１５):３６８６Ｇ３６９６．

IndividualTreefrom TerrestrialLiDARScannerPointCloud
基于地面激光
．
福 州

[D]．Fuzhou:FuzhouUniversity,２０１４．[
雷达点 云 的 单 树 三 维 几 何 建 模 研 究

福 州 大 学

王晓辉

[D]．

:

,

[２６]　 Wang Xiaohui．Three DimensionalGeometrical Modelingof

２０１４．]

TreeHeightandDiameterExtractionwith３DReconstruction
inaForestbasedonTLS

LuoYubo,Huang Hongyu,TangLiyu,ChenChongcheng,Zhang Hao
．KeyLaboratoryofSpatialMiningandInformationSharingofMinistryofEducation
,
(１
SpatialInformationResearchCentreofFujian

Fuzhou

China

FuzhouUniversity,
,

３５０１０８,

)

Abstract

:InviewofthelowaccuracyofTreeHeight(TH)andDiameteratBreastHeight(DBH)estimaＧ
tion,aswellasthedifficultyofindividualtreemodelingindenseforest,amethodtoextractforeststructure
parameters(THandDBH)andreconstructaThreeＧDimensional(３D)modelofforestinsubtropicalenviＧ
ronmentbasedonTLSpointclouddataisproposed．ThefirststepistoapplyamultiＧscalemethodtoexＧ
tractthegroundpointsforthegenerationofDigitalElevation Model(DEM)．Secondly,usingsimilarityof
principaldirectionbetweenneighboringpointsanddistributiondensityofpoints,trunkandotherplantorＧ
gansareseparated．NextthetrunkpointsareprocessedtoautomaticallyestimatethetreepositionandDBH
byiterativeleastsquarescylinderfitting;thetreeheightisautomaticallyestimatedbyusingtheoctreesegＧ
mentation．Finally,bycombining withthetechnologyofindividualtree modeling,aplotＧscale３Dforest
scenehasbeenreconstructedbyplantingindividualtreemodelontheterrainmodeliteratively．Theresults
＝０．９９６,andtheaveragerelativeerrorwas２．０９％,
showedthatthecorrelationcoefficientofDBHis
＝０．９７２,andtheaveragerelativeerror
RMSE was０．６６cm;thecorrelationcoefficientoftreeheightis
was２．１６％ withRMSEof０．９２m．TheplotＧscalereconstructed３D modeloftheforestcanexpressthetrue

R２

R２

shapeofforest．
Keywords

:Terrestriallaserscanner;Treeheight;DiameteratBreastHeight(DBH);PointcloudsegmentaＧ

tion;３Dreconstruction
